@model IEnumerable<LMS.Models.User>

@{
    ViewData["Title"] = "Login";
}

<div class="login-page">

    <!--LOGIN CONTAINER-->
    <div class="login-container text-center">

        <img src="/images/logo.png" alt="" />
        <h1>School LMS</h1>
        <p>
            Enter your credentials to access the learning management system
        </p>
        <form method="post" action="@Url.Action("Login", "Account")" onsubmit="showLoading()">
            @if (ViewBag.Error != null)
            {
                <div class="alert alert-danger small p-2 mt-3 mb-1">@ViewBag.Error</div>
            }

            <label class="w-100 mt-2 text-start">
                Username
                <input type="email" name="email" class="form-control mb-3 mt-2" required />
            </label>

            <label class="w-100 text-start position-relative">
                Password
                <input type="password" name="password" id="passwordInput" class="form-control mt-2" required />
                <span id="togglePassword" class="show-password-icon">
                    <i class="fa fa-eye"></i>
                </span>
            </label>

            <a href="@Url.Action("ForgotPassword", "Account")" class="d-block my-3">Forgot Password?</a>

            <!-- Login Button with built-in spinner -->
            <button type="submit" id="loginBtn" class="login-form-btn w-100 d-flex justify-content-center align-items-center" style="gap:8px;">
                <div id="loginSpinner" class="spinner-border spinner-border-xs text-light" role="status" style="display:none;"></div>
                <span id="loginText">Login</span>
            </button>
        </form>
    </div>
</div>

<style>
    .spinner-border {
        width: 1.5rem;
        height: 1.5rem;
    }
    /* MEDIA QUERIES FOR MOBILE */
@@media (max-width: 767.98px) {
    .login-container {
        padding: 1.5rem 1.5rem;
        margin-bottom: 100px;
    }

    .login-container h1{
        font-size: 1.3rem;
    }

    .login-container p{
        font-size: .8rem;
    }

    .login-form-btn{
        font-size: .95rem;
        padding: .65rem .2rem;
    }

    .login-container img {
        width: 70px;
    }
}

.show-password-icon {
    position: absolute;
    top: 73%;
    right: 15px;
    transform: translateY(-50%);
    cursor: pointer;
    color: #777;
    font-size: 1rem;
}

.show-password-icon:hover {
    color: var(--dark-primary-color);
}

@@media (max-width: 575.98px) {
    .login-container {
        padding: 1rem 1rem;
        max-width: 90%;
    }

    .login-container h1{
        font-size: 1.2rem;
    }

    .login-container p{
        font-size: .75rem;
    }

    .login-container img {
        width: 60px;
    }
}
</style>

<script>

    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('passwordInput');

    togglePassword.addEventListener('click', function () {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        this.innerHTML = type === 'password' ? '<i class="fa fa-eye"></i>' : '<i class="fa fa-eye-slash"></i>';
    });

    function showLoading() {
        const loginBtn = document.getElementById('loginBtn');
        const loginText = document.getElementById('loginText');
        const spinner = document.getElementById('loginSpinner');
        loginBtn.disabled = true;
        loginText.style.display = 'none';
        spinner.style.display = 'inline-block';
    }
</script>


